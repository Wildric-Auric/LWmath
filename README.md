Mainly based on NWengine internal mathematical library, with fixes and extra features.
